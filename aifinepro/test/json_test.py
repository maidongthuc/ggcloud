data = {
    "fire_results": [
        {
            "title": "fire_extinguisher_tray",
            "processed_result": {
                "tray_condition": {
                    "status": "OK",
                    "reason": "The tray exhibits no significant physical damage such as cracks, dents, rust, or punctures that would compromise its integrity or function. A minor scuff mark is present on the top edge of the front panel, slightly to the right of the center."
                },
                "capacity": {
                    "status": "OK",
                    "reason": "The tray is designed with two distinct compartments, each securely holding one fire extinguisher, indicating it is suitable for holding two extinguishers."
                },
                "cleanliness": {
                    "status": "NG",
                    "reason": "Dust accumulation is present on the top surface of the internal divider between the two extinguishers. There is also dust visible on the top edge of the front panel, particularly towards the right side."
                },
                "id": 4,
                "url": [
                    "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_fire_extinguisher_tray_1754985364_e27964bf.jpg",
                    "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_fire_extinguisher_tray_1754985364_b4b20615.jpg"
                ]
            }
        },
        {
            "title": "co2_fire_extinguisher",
            "processed_result": {
                "body": {
                    "status": "OK",
                    "reason": "The body of the fire extinguisher is in good physical condition, with no visible dents, rust, or breaks. The label is present and appears to be fully attached.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_body_1754985364_620b0407.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_body_1754985364_277a787a.jpg"
                    ]
                },
                "handle": {
                    "status": "OK",
                    "reason": "The red metal handle is straight, intact, and shows no signs of bending, breaking, or missing components.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_handle_1754985364_16933753.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_handle_1754985364_5b4b325c.jpg"
                    ]
                },
                "safety_pin": {
                    "status": "OK",
                    "reason": "The silver safety pin is correctly inserted through the handle mechanism and secured by a red plastic tamper seal and red string. It is not missing, loose, or broken.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_safety_pin_1754985364_15389285.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_safety_pin_1754985364_1b713f1a.jpg"
                    ]
                },
                "nozzle": {
                    "status": "OK",
                    "reason": "The black hose and the black cone-shaped nozzle are fully attached, without any visible cracks, breaks, or missing parts.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_hose_1754985364_e323cb55.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_hose_1754985364_a604ac18.jpg"
                    ]
                },
                "cleanliness": {
                    "status": "OK",
                    "reason": "All parts are clean. The body, handle, nozzle/hose, and the valve assembly are free from dirt, dust, or stains.",
                    "object": []
                },
                "id": 2,
                "url": [
                    "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_co2_fire_extinguisher_1754985364_67ad3f8e.jpg",
                    "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_co2_fire_extinguisher_1754985364_3722d0ea.jpg"
                ]
            }
        },
        {
            "title": "dry_chemical_fire_extinguisher",
            "processed_result": {
                "body": {
                    "status": "OK",
                    "reason": "The body is free from any visible dents, rust, breaks, or structural damage. All labels are present and appear to be intact and legible.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_body_1754985364_48200aa1.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_body_1754985364_e29fb905.jpg"
                    ]
                },
                "handle": {
                    "status": "OK",
                    "reason": "The handle mechanism is intact, showing no signs of bending, breaking, or missing components. It appears to be in proper physical condition.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_handle_1754985364_d748396f.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_handle_1754985364_39a6e8e1.jpg"
                    ]
                },
                "safety_pin": {
                    "status": "OK",
                    "reason": "The safety pin is present, correctly inserted through the handle, and secured by an intact red tamper string and a yellow plastic seal, indicating it has not been tampered with or removed.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_safety_pin_1754985364_ed694fcb.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_safety_pin_1754985364_cca8da9b.jpg"
                    ]
                },
                "nozzle": {
                    "status": "OK",
                    "reason": "The hose is properly connected to the valve assembly and extends downwards without any visible cracks, breaks, kinks, or signs of wear along its visible length. The nozzle end is not fully visible but the hose itself is in good condition.",
                    "url": [
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_hose_1754985364_d4d76d73.jpg",
                        "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_hose_1754985364_cffb688f.jpg"
                    ]
                },
                "cleanliness": {
                    "status": "NG",
                    "reason": "The body has a noticeable layer of dust accumulation, particularly on the upper red cylindrical surface and around the white and blue labels. The hose also shows visible dust and light grime along its entire length. The brass fitting of the pressure gauge has a layer of dust.",
                    "object": [
                        "body",
                        "nozzle",
                        "pressure_gauge"
                    ]
                },
                "id": 2,
                "url": [
                    "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_dry_chemical_fire_extinguisher_1754985364_0e9a14cb.jpg",
                    "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_dry_chemical_fire_extinguisher_1754985364_2f1bcdd4.jpg"
                ]
            }
        }
    ],
    "clock_results": {
        "status": "OK",
        "url_image": "N/A",
        "id": 3,
        "reason": "The pressure gauge needle is clearly visible and positioned within the green zone of the gauge. This indicates that the fire extinguisher is at the optimal and safe operating pressure.",
        "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_pressure_gauge_1754985364_e06f6b7a.jpg"
        ]
    },
    "grouped_results": {
        "fire_extinguisher": 2,
        "clock": 1
    }
}

def transform_data(data):
    transformed_results = []
    
    for item in data["fire_results"]:
        title = item["title"]
        processed_result = item["processed_result"]
        
        # Create base structure
        transformed_item = {
            "title": title,
            "url": processed_result.get("url", []),
            "details": []
        }
        
        # Handle fire_extinguisher_tray
        if title == "fire_extinguisher_tray":
            # Add tray_condition
            if "tray_condition" in processed_result:
                transformed_item["details"].append({
                    "item": "tray_condition",
                    "status": processed_result["tray_condition"]["status"],
                    "reason": processed_result["tray_condition"]["reason"]
                })
            
            # Add capacity
            if "capacity" in processed_result:
                transformed_item["details"].append({
                    "item": "capacity",
                    "status": processed_result["capacity"]["status"],
                    "reason": processed_result["capacity"]["reason"]
                })
            
            # Add cleanliness
            if "cleanliness" in processed_result:
                transformed_item["details"].append({
                    "item": "cleanliness",
                    "status": processed_result["cleanliness"]["status"],
                    "reason": processed_result["cleanliness"]["reason"]
                })
        
        # Handle co2_fire_extinguisher and dry_chemical_fire_extinguisher
        elif title in ["co2_fire_extinguisher", "dry_chemical_fire_extinguisher"]:
            components = ["body", "handle", "safety_pin", "nozzle", "cleanliness"]
            
            for component in components:
                if component in processed_result:
                    detail_item = {
                        "item": component,
                        "status": processed_result[component]["status"],
                        "reason": processed_result[component]["reason"]
                    }
                    
                    # Add URL if exists
                    if "url" in processed_result[component]:
                        detail_item["url"] = processed_result[component]["url"]
                    
                    # Add object array for cleanliness if exists
                    if component == "cleanliness" and "object" in processed_result[component]:
                        detail_item["object"] = processed_result[component]["object"]
                    
                    transformed_item["details"].append(detail_item)
            
            # Add pressure_gauge to dry_chemical_fire_extinguisher only
            if title == "dry_chemical_fire_extinguisher" and "clock_results" in data and data["clock_results"]:
                pressure_gauge_detail = {
                    "item": "pressure_gauge",
                    "status": data["clock_results"]["status"],
                    "reason": data["clock_results"]["reason"],
                    "url": data["clock_results"].get("url", [])
                }
                transformed_item["details"].append(pressure_gauge_detail)
        
        # Add id if exists
        if "id" in processed_result:
            transformed_item["id"] = processed_result["id"]
        
        transformed_results.append(transformed_item)
    
    # Note: Clock results are now integrated into dry_chemical_fire_extinguisher
    # No separate clock item needed
    
    return transformed_results

# Transform the data
transformed_data = transform_data(data)

# Print the result
import json
print(json.dumps(transformed_data[3], indent=4, ensure_ascii=False))
