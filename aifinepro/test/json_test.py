data2 = {
  "fire_results": [
    {
      "title": "co2_fire_extinguisher",
      "processed_result": {
        "body": {
          "status": "OK",
          "reason": "The red cylindrical body is free from dents, cracks, significant rust, or any other visible physical damage. The product label is present and fully legible on the front of the cylinder.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_body_1755568619_badc7d91.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_body_1755568619_c45e5ad8.jpg"
          ]
        },
        "handle": {
          "status": "OK",
          "reason": "The red activation lever handle is straight and shows no signs of bending, breakage, or missing components. The black discharge horn/hose, which serves as the carrying handle and discharge outlet, is also intact, with no visible cracks, breaks, or missing parts.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_handle_1755568619_092a83dc.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_handle_1755568619_df757b46.jpg"
          ]
        },
        "safety_pin": {
          "status": "OK",
          "reason": "The safety pin is present and properly inserted through the valve assembly. It is secured by an intact red plastic tamper seal, indicating it has not been tampered with or discharged.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_safety_pin_1755568619_9f6fd246.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_safety_pin_1755568619_2eba7842.jpg"
          ]
        },
        "nozzle": {
          "status": "OK",
          "reason": "The black discharge horn (nozzle) is present and securely attached to the valve assembly. It shows no signs of cracks, breaks, or any other physical damage to its structure.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_hose_1755568619_376b69ad.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_co2_fire_extinguisher_hose_1755568619_e9554d0a.jpg"
          ]
        },
        "cleanliness": {
          "status": "NG",
          "reason": "The fire extinguisher exhibits a light layer of dust accumulation across multiple surfaces. Specifically, the red cylindrical body has a light film of dust, particularly noticeable in the recessed areas around the label and near the top valve assembly. The red activation lever handle and the black discharge horn also show signs of light dust accumulation on their surfaces.",
          "object": [
            "body",
            "handle",
            "nozzle"
          ]
        },
        "id": 2,
        "url": [
          "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_co2_fire_extinguisher_1755568619_c0a2a481.jpg",
          "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_co2_fire_extinguisher_1755568619_92bda624.jpg"
        ]
      }
    },
    {
      "title": "dry_chemical_fire_extinguisher",
      "processed_result": {
        "body": {
          "status": "OK",
          "reason": "The red cylindrical body shows no visible signs of dents, rust, cracks, or other structural damage. The label is present and appears intact on the front.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_body_1755568619_0500dc3d.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_body_1755568619_a28f36c8.jpg"
          ]
        },
        "handle": {
          "status": "OK",
          "reason": "The red operating levers of the handle are straight and show no signs of bending, breaking, or missing components. The pivot point connecting the levers also appears secure and undamaged.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_handle_1755568619_3dd98b1f.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_handle_1755568619_93058289.jpg"
          ]
        },
        "safety_pin": {
          "status": "OK",
          "reason": "The yellow safety pin is present and properly inserted through the handle mechanism, secured by a red plastic tamper seal, indicating it is not loose or broken.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_safety_pin_1755568619_440edf9f.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_safety_pin_1755568619_7e9a8de8.jpg"
          ]
        },
        "nozzle": {
          "status": "OK",
          "reason": "The black rubber hose is securely attached to the valve assembly and shows no visible signs of cracks, breaks, tears, or deterioration. The nozzle end appears to be present and intact at the end of the hose.",
          "url": [
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_hose_1755568619_8c25f060.jpg",
            "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_highlighted_dry_chemical_fire_extinguisher_hose_1755568619_d50dbc42.jpg"
          ]
        },
        "cleanliness": {
          "status": "NG",
          "reason": "The entire body, handle, safety pin, hose, and pressure gauge are covered with a visible, uniform layer of fine dust, indicating a lack of recent cleaning.",
          "object": [
            "body",
            "handle",
            "nozzle",
            "pressure_gauge"
          ]
        },
        "id": 2,
        "url": [
          "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_dry_chemical_fire_extinguisher_1755568619_e489c359.jpg",
          "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_dry_chemical_fire_extinguisher_1755568619_bcb208d5.jpg"
        ]
      }
    },
    {
      "title": "fire_extinguisher_tray",
      "processed_result": {
        "tray_condition": {
          "status": "OK",
          "reason": "No visible physical damage such as cracks, dents, rust, or punctures are present on the tray."
        },
        "capacity": {
          "status": "OK",
          "reason": "The tray is designed with two distinct compartments and securely holds two fire extinguishers."
        },
        "cleanliness": {
          "status": "NG",
          "reason": "Light dust is present on the top edges of the tray, and on the interior base between the two fire extinguishers."
        },
        "id": 4,
        "url": [
          "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_fire_extinguisher_tray_1755568619_7874d5ef.jpg",
          "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_fire_extinguisher_tray_1755568619_551bc1ed.jpg"
        ]
      }
    }
  ],
  "clock_results": {
    "status": "NG",
    "id": 3,
    "reason": "The pressure gauge needle is clearly visible and positioned within the yellow zone, indicating that the pressure is outside the acceptable green operating range. The yellow zone typically signifies an overpressure condition for fire extinguishers, making it a non-compliant status.",
    "url": [
      "http://0.0.0.0:8080/static/images/results/FIRE/FIRE_result_pressure_gauge_1755568619_f221a30f.jpg"
    ]
  },
  "grouped_results": {
    "clock": 1,
    "fire_extinguisher": 2
  }
}

def transform_data(data):
    # Dictionary mapping English item names to multi-language names with product codes
    item_name_mapping = {
        "co2_fire_extinguisher": {
            "tray_condition": {
                "en": "Tray Condition",
                "vi": "Tình trạng khay",
                "zh-CN": "托盘状况", 
                "zh-TW": "托盤狀況"
            },
            "capacity": {
                "en": "Capacity",
                "vi": "Dung tích",
                "zh-CN": "容量",
                "zh-TW": "容量"
            },
            "cleanliness": {
                "en": "Cleanliness",
                "vi": "Độ sạch sẽ",
                "zh-CN": "清洁度",
                "zh-TW": "清潔度"
            },
            "body": {
                "en": "CO2 Fire Extinguisher Body MT3",
                "vi": "Thân bình MT3",
                "zh-CN": "MT3 二氧化碳灭火器瓶身",
                "zh-TW": "MT3 二氧化碳滅火器瓶身"
            },
            "handle": {
                "en": "CO2 Fire Extinguisher Handle MT3",
                "vi": "Cò bóp MT3",
                "zh-CN": "MT3 二氧化碳灭火器手柄",
                "zh-TW": "MT3 二氧化碳滅火器手柄"
            },
            "safety_pin": {
                "en": "CO2 Fire Extinguisher Safety Pin MT3",
                "vi": "Chốt an toàn MT3",
                "zh-CN": "MT3 二氧化碳灭火器安全销",
                "zh-TW": "MT3 二氧化碳滅火器安全銷"
            },
            "nozzle": {
                "en": "CO2 Fire Extinguisher Nozzle MT3",
                "vi": "Vòi phun MT3",
                "zh-CN": "MT3 二氧化碳灭火器喷嘴",
                "zh-TW": "MT3 二氧化碳滅火器噴嘴"
            },
            "pressure_gauge": {
                "en": "CO2 Fire Extinguisher Pressure Gauge MT3",
                "vi": "Đồng hồ áp suất MT3",
                "zh-CN": "MT3 二氧化碳灭火器压力表",
                "zh-TW": "MT3 二氧化碳滅火器壓力表"
            }
        },
        "dry_chemical_fire_extinguisher": {
            "tray_condition": {
                "en": "Tray Condition",
                "vi": "Tình trạng khay",
                "zh-CN": "托盘状况",
                "zh-TW": "托盤狀況"
            },
            "capacity": {
                "en": "Capacity",
                "vi": "Dung tích",
                "zh-CN": "容量",
                "zh-TW": "容量"
            },
            "cleanliness": {
                "en": "Cleanliness",
                "vi": "Độ sạch sẽ",
                "zh-CN": "清洁度",
                "zh-TW": "清潔度"
            },
            "body": {
                "en": "Dry Chemical Fire Extinguisher Body MFZ8",
                "vi": "Thân bình MFZ8",
                "zh-CN": "MFZ8 干粉灭火器瓶身",
                "zh-TW": "MFZ8 乾粉滅火器瓶身"
            },
            "handle": {
                "en": "Dry Chemical Fire Extinguisher Handle MFZ8",
                "vi": "Cò bóp MFZ8",
                "zh-CN": "MFZ8 干粉灭火器手柄",
                "zh-TW": "MFZ8 乾粉滅火器手柄"
            },
            "safety_pin": {
                "en": "Dry Chemical Fire Extinguisher Safety Pin MFZ8",
                "vi": "Chốt an toàn MFZ8",
                "zh-CN": "MFZ8 干粉灭火器安全销",
                "zh-TW": "MFZ8 乾粉滅火器安全銷"
            },
            "nozzle": {
                "en": "Dry Chemical Fire Extinguisher Nozzle MFZ8",
                "vi": "Vòi phun MFZ8",
                "zh-CN": "MFZ8 干粉灭火器喷嘴",
                "zh-TW": "MFZ8 乾粉滅火器噴嘴"
            },
            "pressure_gauge": {
                "en": "Dry Chemical Fire Extinguisher Pressure Gauge MFZ8",
                "vi": "Đồng hồ áp suất MFZ8",
                "zh-CN": "MFZ8 干粉灭火器压力表",
                "zh-TW": "MFZ8 乾粉滅火器壓力表"
            }
        },
        "fire_extinguisher_tray": {
            "tray_condition": {
                "en": "Tray Condition",
                "vi": "Tình trạng khay",
                "zh-CN": "托盘状况",
                "zh-TW": "托盤狀況"
            },
            "capacity": {
                "en": "Capacity",
                "vi": "Dung tích",
                "zh-CN": "容量",
                "zh-TW": "容量"
            },
            "cleanliness": {
                "en": "Cleanliness",
                "vi": "Độ sạch sẽ",
                "zh-CN": "清洁度",
                "zh-TW": "清潔度"
            }
        }
    }
    
    transformed_results = []
    
    for item in data["fire_results"]:
        title = item["title"]
        processed_result = item["processed_result"]
        
        # Get the appropriate mapping for this title
        current_mapping = item_name_mapping.get(title, {})
        
        # Create base structure - đổi 'url' thành 'images'
        transformed_item = {
            "title": title,
            "images": processed_result.get("url", []),  # Đổi từ "url" thành "images"
            "details": []
        }
        
        # Handle fire_extinguisher_tray
        if title == "fire_extinguisher_tray":
            # Add tray_condition
            if "tray_condition" in processed_result:
                transformed_item["details"].append({
                    "item": "tray_condition",
                    "name": current_mapping.get("tray_condition", {
                        "en": "tray_condition",
                        "vi": "tray_condition", 
                        "zh-CN": "tray_condition",
                        "zh-TW": "tray_condition"
                    }),
                    "status": processed_result["tray_condition"]["status"],
                    "reason": processed_result["tray_condition"]["reason"]
                })
            
            # Add capacity
            if "capacity" in processed_result:
                transformed_item["details"].append({
                    "item": "capacity",
                    "name": current_mapping.get("capacity", {
                        "en": "capacity",
                        "vi": "capacity",
                        "zh-CN": "capacity", 
                        "zh-TW": "capacity"
                    }),
                    "status": processed_result["capacity"]["status"],
                    "reason": processed_result["capacity"]["reason"]
                })
            
            # Add cleanliness
            if "cleanliness" in processed_result:
                cleanliness_item = {
                    "item": "cleanliness",
                    "name": current_mapping.get("cleanliness", {
                        "en": "cleanliness",
                        "vi": "cleanliness",
                        "zh-CN": "cleanliness",
                        "zh-TW": "cleanliness"
                    }),
                    "status": processed_result["cleanliness"]["status"],
                    "reason": processed_result["cleanliness"]["reason"]
                }
                
                # Nếu cleanliness NG, thêm images của item tổng thay vì object
                if processed_result["cleanliness"]["status"] == "NG":
                    cleanliness_item["images"] = processed_result.get("url", [])
                
                transformed_item["details"].append(cleanliness_item)
        
        # Handle co2_fire_extinguisher and dry_chemical_fire_extinguisher
        elif title in ["co2_fire_extinguisher", "dry_chemical_fire_extinguisher"]:
            components = ["body", "handle", "safety_pin", "nozzle", "cleanliness"]
            
            for component in components:
                if component in processed_result:
                    detail_item = {
                        "item": component,
                        "name": current_mapping.get(component, {
                            "en": component,
                            "vi": component,
                            "zh-CN": component,
                            "zh-TW": component
                        }),
                        "status": processed_result[component]["status"],
                        "reason": processed_result[component]["reason"]
                    }
                    
                    # Xử lý đặc biệt cho cleanliness
                    if component == "cleanliness":
                        if processed_result[component]["status"] == "NG":
                            # Thêm images của item tổng thay vì object
                            detail_item["images"] = processed_result.get("url", [])
                        # Không thêm object nữa
                    else:
                        # Add images cho các component khác (không phải cleanliness)
                        if "url" in processed_result[component]:
                            detail_item["images"] = processed_result[component]["url"]
                    
                    transformed_item["details"].append(detail_item)
            
            # Add pressure_gauge to dry_chemical_fire_extinguisher only
            if title == "dry_chemical_fire_extinguisher" and "clock_results" in data and data["clock_results"]:
                pressure_gauge_detail = {
                    "item": "pressure_gauge",
                    "name": current_mapping.get("pressure_gauge", {
                        "en": "pressure_gauge",
                        "vi": "pressure_gauge",
                        "zh-CN": "pressure_gauge",
                        "zh-TW": "pressure_gauge"
                    }),
                    "status": data["clock_results"]["status"],
                    "reason": data["clock_results"]["reason"],
                    "images": data["clock_results"].get("url", [])  # Đổi từ "url" thành "images"
                }
                transformed_item["details"].append(pressure_gauge_detail)
        
        transformed_results.append(transformed_item)
    
    return transformed_results

# Transform the data
transformed_data = transform_data(data2)

# Print the result
import json
print(json.dumps(transformed_data, indent=4, ensure_ascii=False))